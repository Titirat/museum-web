<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
<header>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <title>SPLICE WEBSITE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--splice-->
    <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">

    <!--choose file show image-->
    <link class="jsbin" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
    <meta charset=utf-8 />
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--end choose file show image-->

    <!-- BOOTSTRAP STYLES-->
    <link href="css/cssAdmin/bootstrap.css" rel="stylesheet"/>
    <!-- FONTAWESOME STYLES-->
    <link href="css/cssAdmin/font-awesome.css" rel="stylesheet"/>
    <!-- GOOGLE FONTS-->
    <link href="css/cssAdmin/res.css" rel="stylesheet"/>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <!--end splice-->

    <link rel="stylesheet" href="css/normalize.css">

    <link rel="stylesheet" href="css/canvas.css">
    <link rel="stylesheet" href="css/uploadFile.css">
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    <script src="js/uploadFile.js"></script>


    <!--button for this page-->
    <script src="js/jscolor.js"></script>
    <!--start sidebar-->


    <style>
        article, aside, figure, footer, header, hgroup,
        menu, nav, section { display: block; }

        .closeImage {
            position: absolute;
            float:left;
            clear: none;
            width:15px;
            height:14px;
            background:url(https://www.secretsof.com/images/close_x.png) no-repeat center center;
        }

        .thumbnail {
            height: 100px;
            width: auto;
        }

        #uploadedImages {}



    </style>
    <!--sidebar-->

</header>
<body>
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Add your site or application content here -->

<script src="https://code.jquery.com/jquery-{{JQUERY_VERSION}}.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-{{JQUERY_VERSION}}.min.js"><\/script>')</script>
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script src="js/circleCanvas.js"></script>
<!--js from pizza-->
<!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
<!-- JQUERY SCRIPTS -->
<script src="js/jquery-1.10.2.js"></script>
<!-- BOOTSTRAP SCRIPTS -->
<script src="js/bootstrap.min.js"></script>
<!-- METISMENU SCRIPTS -->
<script src="js/jquery.metisMenu.js"></script>
<!-- CUSTOM SCRIPTS -->
<script src="js/custom.js"></script>


<!-- HERE -->

<div id="wrapper">
    <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../pizza/chief/index.html">Welcome to</a>
        </div>
        <div style="color: white;
                padding: 0px 50px 5px 50px;
                float: left;
                font-size: 16px;">
            <h3>Interactive Museum Application</h3>


        </div>

        <div style="color: white;
                padding: 15px 50px 5px 50px;
                float: right;
                font-size: 16px;">
            <a href="login.html" class="btn btn-info square-btn-adjust">Logout</a>
        </div>

    </nav>
    <!-- /. NAV TOP  -->



    <nav class="navbar-default navbar-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav" id="main-menu">
                <li class="text-center">
                    <img src="/img/icon.png" class="user-image img-responsive">
                </li>



                <li><a href="index.html">LOGO</a></li>
                <li><a href="default.html">DEFAULT</a></li>
                <li><a class="active" href="map.html">MAP</a></li>
                <li><a href="testContent.php">CONTENT</a></li>
                <li><a href="gallery.html">GALLERY</a></li>
                <li><a href="audio.html">AUDIO</a></li>
                <li><a href="uuid.html">UUID</a></li>
                <li><a href="arqr.html">QR & AR</a></li>

            </ul>

        </div>

    </nav>


    <!-- /. NAV SIDE  -->
    <div id="page-wrapper" >
        <div id="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="page-head-line">Map</h2>
                </div>
            </div>
            <!-- /. ROW  -->
            <hr/>

            <div class="row">
                <!--left 5-->
                <div class="col-md-5">
                    <div class="portfolio-item awesome mix_all" data-cat="awesome" >
                        <img id="myImg" src="/img/map.png" class="img-responsive " alt="" width="280" height="550"/>
                        <!--สี่เหลี่ยมของheader-->
                        <p id="header" style="border:1px solid gray; width:237px; height:43px; position:absolute; top:85px; left:37px;">
                            <!--สี่เหลี่ยมของtaskbar-->
                        <p id="rect" style="border:1px solid gray; width:237px; height:26px; position:absolute; top:127px; left:37px;">

                    </div>
                    <!--mockup phone-->

                    <!--กรอบในไอโฟน-->
                    <canvas id="headerCanvas"  width="236" height="41" style="border:0px solid #000000; position:absolute; top:83px; left:21px;">
                        Your browser does not support the HTML5 canvas tag.</canvas>
                    <canvas id="mapCanvas"  width="235" height="336" style="border:1px solid #000000; position:absolute; top:153px; left:37px;">
                        Your browser does not support the HTML5 canvas tag.</canvas>
                </div>
                <!--end left-->

                <!--right 7-->
                <div class="col-md-7">
                    <form action="uploadIndex.php" method="POST" enctype="multipart/form-data">
                        <!--Header color-->
                        <div class="row">
                            <label>Header color:</label>
                            <input class="jscolor {onFineChange:'change(this)'}" value="ffffff" name="header">

                        </div>

                        <hr/>
                        <!--taskbar-->
                        <div class="row">
                            <label>Task bar color:</label>
                            <input class="jscolor {onFineChange:'update(this)'}" value="ffffff" id="taskbar" name="taskbar">
                        </div>
                        <hr/>
                        <!--floor-->
                        <div class="row">
                            <label>Upload map</label>
                            <div class="row">
                                <div class="col-md-2">
                                    <select style="margin: 7px 0;" id="floor_level" name="floor_level">
                                        <option value="1" selected>Floor 1</option>
                                        <option value="2">Floor 2</option>
                                        <option value="3">Floor 3</option>
                                        <option value="4">Floor 4</option>
                                        <option value="5">Floor 5</option>
                                        <option value="6">Floor 6</option>
                                        <option value="7">Floor 7</option>
                                        <option value="8">Floor 8</option>
                                        <option value="9">Floor 9</option>
                                        <option value="0">Floor 10</option>
                                    </select>
                                </div>

                                <div class="col-md-4">
                                    <input type="text" class="form-control" id="floor_name" name="floor_name" placeholder="Floor name">
                                </div>

                                <div class="col-md-6">
                                    <input type="file" id="image_upload_path" name="image">
                                </div>
                            </div>
                            <!--row-->
                        </div>
                        <hr/>
                        <!--upload button-->
                        <div id="uploadedImages"></div>
                        <input class="btn btn-info submit1" type="button" onclick="changeText2()" value="Upload">

                    </form>
                    <progress style="display: none;" value="237988" max="237988"> </progress>
                    <div id="errorMsg"></div>
                </div>
                <!--end right-->


            </div>

            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
    <!-- /. WRAPPER  -->
<!--ENDsidebar-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript">

    var list = document.getElementById('demo');

    function changeText2() {
//    var firstname = document.getElementById('firstname').value;
//    document.getElementById('boldStuff2').innerHTML = firstname;
//    var entry = document.createElement('li');
//    entry.appendChild(document.createTextNode(firstname));
//    list.appendChild(entry);

        var data = {'image': $('#image_upload_path').val(), 'floor_level': $('#floor_level').val(), 'floor_name': $('#floor_name').val()};

        console.log(new FormData(data));

        var formData = new FormData($('form')[0]);

        $.ajax({
            url: '/uploadMap.php',  //Server script to process data
            type: 'POST',
            xhr: function() {  // Custom XMLHttpRequest
                var myXhr = $.ajaxSettings.xhr();
                if(myXhr.upload){ // Check if upload property exists
                    myXhr.upload.addEventListener('progress',progressHandlingFunction, false); // For handling the progress of the upload
                }
                return myXhr;
            },
            //Ajax events
            beforeSend: beforeSendHandler,
            success: completeHandler,
            error: errorHandler,
            // Form data
            data: formData,
            //Options to tell jQuery not to process data or worry about content-type.
            cache: false,
            contentType: false,
            processData: false
        });
    }
    function beforeSendHandler() {
        $('progress').show();
    }
    function completeHandler(data) {
        //console.log(data.log);
        if (data.result) {
            console.log('data.result[0]: ',data.result[0]);
            if (data.result[0] == '/') {
                var newImage = $('<img>',{
                    class: 'thumbnail',
                    src: data.result
                });

                var imageDetail = '<span>' + 'Floor level: ' + $('#floor_level').val() + '</span><br>';
                imageDetail += '<span>' + 'Floor name: ' + $('#floor_name').val() + '</span>';

                var closeLink = $('<span>', {class: "closeImage"});
                var container = $('<span>').append(closeLink, newImage, imageDetail);

                $('#floor_level').val(1);
                $('#floor_name').val('');
                $('#image_upload_path').val('');


                $('#uploadedImages').append(container);
            }
            else {
                $('#errorMsg').html(data.result);
            }
        }
        $('progress').hide();
        console.log('completeHandler',data);
    }
    function errorHandler() {
        console.log('completeHandler',arguments);
    }
    function progressHandlingFunction(e){
        if(e.lengthComputable){
            $('progress').attr({value:e.loaded,max:e.total});
        }
    }
    //handle clicking on the closeImage links
    $(document).ready(function(readyEvent) {
        $(document).click(function(clickEvent) {
            if ($(clickEvent.target).hasClass('closeImage')) {
                clickEvent.target.parentNode.remove();
            }
        });
    });</script>
<!-- END HERE -->
<script>

    <!--upload and show image in canvas map-->

    var mapImageLoader = document.getElementById('map');
    mapImageLoader.addEventListener('change', handleImageMap, false);
    var mapCanvas = document.getElementById('mapCanvas');
    var mapCanvasContext = mapCanvas.getContext('2d');

    function handleImageMap(e){
        console.log("handleMap");

        var reader = new FileReader();
        reader.onload = function(event){
            var img = new Image();
            img.src = event.target.result;

            img.onload = function(){
                mapCanvasContext.drawImage(img,0,0,img.width,img.height,0,0,236,413);
            }
        }
        reader.readAsDataURL(e.target.files[0]);
    }

    <!--for task bar-->
    function update(jscolor) {
        // 'jscolor' instance can be used as a string
        document.getElementById('rect').style.backgroundColor = '#' + jscolor
    }

    function change(jscolor) {
        // 'jscolor' instance can be used as a string
        document.getElementById('header').style.backgroundColor = '#' + jscolor
    }




</script>



</body>
</html>
